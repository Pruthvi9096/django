{% extends 'main.html' %}
{% block content %}
{% load static %}
<div class="row mt-3">
  <div style="width: 800px; margin: 0 auto;">
    {% if messages %}
    <ul class="alert alert-success" style="list-style: none;">
      {% for message in messages %}
      <li{% if message.tags %} class="{{ message.tags }}" {% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
  </div>
  <div class="col-md-4">
    <div class="card box-element" style="width: 18rem;">
      {% if profile.profile_image%}
      <img src="{{profile.profile_image.url}}" class="avatar" alt="...">
      {% else %}
      <img src="http://www.gravatar.com/avatar/?d=identicon" class="avatar" alt="...">
      {% endif %}
      <div class="card-body">
        <h5 class="card-title">{{request.user.username}}</h5>
        <p class="card-text text-muted">
          {% if profile %}
          {{profile.bio|safe}}
        </p>
        {% endif %}
        <div style="display: flex;">
          <div style="flex:3">
            <h6 class="text-center"><b>{{profile.follower_count}}<p>Followers</p></b></h6>
          </div>
          <div style="flex:3">
            <h6 class="text-center"><b>{{profile.following_count}}<p>Following</p></b></h6>
          </div>
          <div style="flex:3">
            <h6 class="text-center"><b>{{profile.post_count}}<p>Posts</p></b></h6>
          </div>
        </div>
        <div>
          <a href="{% url 'update-profile' %}" class="btn btn-outline-dark">Update Profile</a>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-7 mx-auto box-element" style="height:max-content;">
    <ul class="nav nav-pills mt-3 mb-3" id="pills-tab" role="tablist">
      <li class="nav-item" role="presentation">
        <a class="nav-link active" id="pills-feed-tab" data-toggle="pill" href="#pills-feed" role="tab"
          aria-controls="pills-feed" aria-selected="true">Feed</a>
      </li>
      <li class="nav-item" role="presentation">
        <a class="nav-link" id="pills-explore-tab" data-toggle="pill" href="#pills-explore" role="tab"
          aria-controls="pills-explore" aria-selected="false">Explore</a>
      </li>
      <li class="nav-item" style="margin: 0 auto;" role="presentation">
        <a href="{% url 'create-post' %}" class="btn btn-outline-info">Create Post</a>
      </li>
    </ul>
    <div class="tab-content" id="pills-tabContent">
      <div class="tab-pane fade show active" id="pills-feed" role="tabpanel" aria-labelledby="pills-feed-tab">
        <h3>Feed</h3>
        {% for post in feed_posts %}
        <div class="card mb-2">
          <div class="card-header">
            {{post.title}}
            <a style="float: right;" href="{% url 'visit-profile' post.author.id %}">{{post.author.user.username}}</a>
          </div>
          <div class="card-body" onclick="location.href='{% url 'post-detail' post.id %}'">
            {{post.content|safe}}
          </div>
        </div>
        {% endfor %}
      </div>
      <div class="tab-pane fade" id="pills-explore" role="tabpanel" aria-labelledby="pills-explore-tab">
        <h5>People may you know</h5>
        {% include 'profile_list.html' with profiles=explore_profiles%}
      </div>
    </div>
  </div>
</div>
{% endblock%}